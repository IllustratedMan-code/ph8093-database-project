#+title: Final Project Proposal
#+author: David Lewis
#+date:<2025-10-30 Thu>

#+export_file_name: FinalProjectProposal_Lewis

* Introduction

** Background
There are lots of medicines that do different things. It is hard for physicians to
pick between each of the different medications. Simplifying the list of medications is
therefore important to patient care.

** Research questions
- Which medications with the same compositions are the highest rated?
- How does the usage of the medication correlate with user reviews?
- How do side effects correlate?
- How can a physician easily browse for medications?

* Methods

** Data collection

The data were collected from Kaggle using the search term "medicine". The dataset
is located at the following URL: https://www.kaggle.com/datasets/singhnavjot2062001/11000-medicine-details

** Data Manipulation
The data was originally a single CSV. There were many "many-to-many" relationships, which I've
extracted (reverse group-by?) into separate tables.

The Medications table is shown below:
  

#+begin_src python :results table :exports results
import sqlite3
import pandas as pd

con = sqlite3.connect("data/11000-medicines.db")
df = pd.read_sql_query("select * from Medications", con)
return(df.drop("Image URL", axis=1).head(11))
#+end_src

#+RESULTS:
|    | Medicine Name            | Manufacturer                         | Excellent Review % | Average Review % | Poor Review % |
|----+--------------------------+--------------------------------------+--------------------+------------------+---------------|
|  0 | Avastin 400mg Injection  | Roche Products India Pvt Ltd         |                 22 |               56 |            22 |
|  1 | Augmentin 625 Duo Tablet | Glaxo SmithKline Pharmaceuticals Ltd |                 47 |               35 |            18 |
|  2 | Azithral 500 Tablet      | Alembic Pharmaceuticals Ltd          |                 39 |               40 |            21 |
|  3 | Ascoril LS Syrup         | Glenmark Pharmaceuticals Ltd         |                 24 |               41 |            35 |
|  4 | Aciloc 150 Tablet        | Cadila Pharmaceuticals Ltd           |                 34 |               37 |            29 |
|  5 | Allegra 120mg Tablet     | Sanofi India Ltd                     |                 35 |               42 |            23 |
|  6 | Avil 25 Tablet           | Sanofi India Ltd                     |                 40 |               34 |            26 |
|  7 | Aricep 5 Tablet          | Eisai Pharmaceuticals India Pvt Ltd  |                 43 |               28 |            29 |
|  8 | Amoxyclav 625 Tablet     | Abbott                               |                 36 |               43 |            21 |
|  9 | Atarax 25mg Tablet       | Dr Reddy's Laboratories Ltd          |                 35 |               41 |            24 |
| 10 | Azee 500 Tablet          | Cipla Ltd                            |                 37 |               38 |            25 |

#+begin_quote
I'm hiding the =Image URL= column here"
#+end_quote

Some stats from the tables:
#+begin_src python :session tables :exports none
import sqlite3
import pandas as pd

con = sqlite3.connect("data/11000-medicines.db")
#+end_src

#+RESULTS:
: None

*** Medications table
#+begin_src python :exports results :results table :session tables
df = pd.read_sql_query("select * from Medications", con)
pd.DataFrame(df.nunique(), columns=["Unique Counts"])
#+end_src

#+RESULTS:
|                    | Unique Counts |
|--------------------+---------------|
| Medicine Name      |         11498 |
| Image URL          |         11740 |
| Manufacturer       |           759 |
| Excellent Review % |            85 |
| Average Review %   |            79 |
| Poor Review %      |            81 |


*** Medications Uses Junction table
#+begin_src python :exports results :session tables :results table
df = pd.read_sql_query("select * from Medications_Uses", con)
pd.DataFrame(df.nunique(), columns=["Unique Counts"])
#+end_src

#+RESULTS:
|                  | Unique Counts |
|------------------+---------------|
| Medicine Uses ID |         17811 |
| Medicine Name    |         11498 |
| Use              |           469 |


** ER diagram
#+begin_src mermaid :file erdiagram.png
erDiagram
    Medications {
      string Medicine_Name PK
      string Image_URL
      string Manufacturer
      int Excellent_Review_Percent
      int Average_Review_Percent
      int Poor_Review_Percent
    }
    Medications_Components {
      string Medicine_Component_ID PK
      string Medicine_Name FK
      string Component_Name FK
      string Amount
    }

    Components {
      string Component_Name PK
    }

    Medications_Uses {
      string Medicine_Use_ID PK
      string Medicine_Name FK
      string Use FK
    }
    
    Uses {
      string Use PK
    }

    Medications_Side_effects {
      string Medicine_Side_effect_ID PK
      string Medicine_Name FK
      string Side_effect FK
    }

    Side_effects {
      string Side_effect PK 
    }

    Medications ||--|{ Medications_Uses : ""
    Uses ||--|{ Medications_Uses : ""
    Medications ||--|{ Medications_Components : ""
    Components ||--|{ Medications_Components : ""
    Medications ||--|{ Medications_Side_effects : ""
    Side_effects ||--|{ Medications_Side_effects : ""
    
#+end_src

#+RESULTS:
[[file:erdiagram.png]]

This ER diagram makes sense because the original dataset in csv had columns that were
lists with non-unique elements, i.e. a many-to many relationship. This database takes those
columns and extracts the columns as their own tables, connecting them via a junction table.


** Data analysis
- Statistical analysis to determine effect of Use/Composition/Side effects on Review
- Compare reviews of medicines with similar compositions (determine what "similar" means in this context)

** R Packages

*** Statistical packages
- Tidyverse
- Plotly

Pretty sure I can do all the statistical analysis I need to without any extra packages. Tidyverse is a family of data manipulation/visualization tools and
plotly is for interactive visualization.

*** Shiny stuff
- Shiny
- Shiny Router
- Box

Shiny should be self-explanatory, but shiny router and box allow for actual modularization within the R app (i.e. I don't have to store everything in the same file).


** Interactive Visualizations
- Searchable histogram (i.e. histogram changes)
  for each component's dosages
- Searchable component to review histogram
  

** Layout

1 tab for non-interactive/interactive data vizualization, another for browsing the data.

#+begin_quote
I'm not really sure /which/ plots I'm using yet, but there will be plots on the first page, data browser on the second
#+end_quote 


*** Page 1

[[file:assets/mockup1.svg]]

*** Page 2




[[file:assets/mockup2.png]]





** non-interactive visualizations (ggplot/plotly)
In general, these will be visualizations for the entirety of the data
- Some sort of scatter plot showing relationships between medications (UMAP/PCA) based
  on various metrics (need to define similarity metric)
- Will try to use plotly for everything, since it allows for interactive inspection of points

#+begin_quote
I have some other ideas for this, but nothing super detailed yet.
#+end_quote

** Filters
- I'm not going to filter the data at all, since there is no statistical score to do so with, i.e. p value.

** How proposed visualizations help answer the research questions?

- The interactive data viewer will help physicians connect medications to symptoms/reviews/etc.
- Interactive/non interactive visualizations may show how some medications may be really well received by some, but terrible for others
- UMAP/PCA plot may show distinct groups of medicines in terms of side effect, uses, etc. May be able to select alternative medications
  based on groups.
